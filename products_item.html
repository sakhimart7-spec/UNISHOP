<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Hero Layout</title>
<link rel="stylesheet" href="footer.css">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
<style>

/* RESET */
*{
    margin:0;
    padding:0;
    box-sizing:border-box;
    font-family: 'Inter', sans-serif;
}

body{
    overflow-x:hidden;
}

/* HERO SECTION */
.hero{
    position:relative;
    width:100%;
    height:80px;
    overflow:hidden;
    background-color: #111;
}

/* VIDEO BACKGROUND */
.hero video{
    position:absolute;
    width:100%;
    height:100%;
    object-fit:cover;
}

/* DARK OVERLAY */
.hero::after{
    content:'';
    position:absolute;
    width:100%;
    height:100%;
    background:rgba(0,0,0,0.25);
    top:0;
    left:0;
    z-index:-1;
}

/* NAVBAR */
.navbar{
    position:absolute;
    top:0;
    left:0;
    width:100%;
    padding:20px 5%;
    display:flex;
    justify-content:space-between;
    align-items:center;
    color:#fff;
}

/* LOGO */
.logo img{
    height:40px;
}

/* NAV LINKS */
.nav-links{
    display:flex;
    gap:40px;
    font-weight:500;
    letter-spacing:1px;
}

.nav-links a{
    text-decoration:none;
    color:#fff;
    font-size:14px;
    position:relative;
}

.nav-links a::after{
    content:'';
    position:absolute;
    left:0;
    bottom:-5px;
    width:0%;
    height:2px;
    background:#fff;
    transition:0.3s;
}

.nav-links a:hover::after{
    width:100%;
}

/* ICONS */
.nav-icons{
    display:flex;
    gap:25px;
    align-items:center;
}

.nav-icons i{
    font-size:18px;
    cursor:pointer;
    color:#ffffff !important;
    transition:0.3s;
}

.nav-icons i:hover{
    opacity:0.7;
}

/* MENU TOGGLE (MOBILE) */
.menu-toggle{
    display:none;
    font-size:24px;
    cursor:pointer;
}



/* MOBILE MENU */
.mobile-menu{
    position:fixed;
    top:0;
    right:-100%;
    width:70%;
    height:100%;
    background:#000;
    color:#fff;
    padding:80px 30px;
    transition:0.4s ease;
    display:flex;
    flex-direction:column;
    gap:30px;
    z-index:999;
}

.mobile-menu a{
    text-decoration:none;
    color:#fff;
    font-size:18px;
}

.mobile-menu.active{
    right:0;
}

.mobile-header{
    position:absolute;
    top:20px;
    right:25px;
}

.mobile-header i{
    font-size:22px;
    cursor:pointer;
    color:#fff;
}

/* RESPONSIVE */
@media(max-width:992px){

    .nav-links{
        display:none;
    }

    .menu-toggle{
        display:block;
    }

    .hero-content h1{
        font-size:30px;
    }

    .hero-content{
        bottom:15%;
    }
  
}








.product-details{
    max-width:1200px;
    margin:auto;
    padding:40px 20px;
}

.product-main{
    display:flex;
    gap:50px;
    align-items:center;
    flex-wrap:wrap;
}

.product-image img{
    width:100%;
    max-width:500px;
    border-radius:20px;
    box-shadow:0 20px 40px rgba(0,0,0,0.1);
}

.product-info{
    flex:1;
}

.product-info h1{
    font-size:32px;
    margin-bottom:15px;
}

.description{
    color:#555;
    margin-bottom:20px;
    line-height:1.6;
}

.price{
    font-size:28px;
    color:#9333ea;
    margin-bottom:20px;
}

.product-actions{
    display:flex;
    gap:15px;
}

.cart-btn,
.buy-btn{
    padding:12px 25px;
    border:none;
    border-radius:8px;
    cursor:pointer;
    font-weight:600;
}

.cart-btn{
    background:#eee;
}
.cart-btn:hover{
    color: white;
    background:#1d00ae;
}


.buy-btn{
    background:linear-gradient(135deg,#9333ea,#7e22ce);
    color:#fff;
}
.similar-title{
    margin-top:60px;
    font-size:22px;
}

/* Container */
.similar-products{
    display:flex;
    gap:15px;
    overflow-x:auto;
    padding:20px 0;
    scroll-behavior:smooth;
}

/* Hide scrollbar (optional clean look) */
.similar-products::-webkit-scrollbar{
    display:none;
}

/* Card */
.similar-card{
    flex: 0 0 160px;   /* üî• fixed small width */
    background:#fff;
    padding:10px;
    border-radius:12px;
    box-shadow:0 5px 15px rgba(0,0,0,0.08);
    cursor:pointer;
    transition:0.3s;
    text-align:center;
}

.similar-card:hover{
    transform:translateY(-5px);
}

/* Image */
.similar-card img{
    width:100%;
    height:140px;       /* smaller image */
    object-fit:contain; /* show full image */
    background:#f8f8f8;
    border-radius:10px;
}

/* Title */
.similar-card h4{
    font-size:14px;
    margin:8px 0 4px;
}

/* Price */
.similar-card p{
    font-size:13px;
    color:#9333ea;
    font-weight:600;
}
@media(max-width:768px){
    .product-main{
        flex-direction:column;
    }

    .product-info h1{
        font-size:24px;
    }
   
    .similar-products{
        gap:12px;
        padding-left:10px;
    }

    .similar-card{
        flex: 0 0 130px;  /* smaller on mobile */
    }

    .similar-card img{
        height:110px;
    }

}



















.user-dropdown {
    position: absolute;
    top: 60px; /* adjust based on navbar height */
    right: 20px;
    width: 220px;
    background: #111; /* dark theme */
    color: #fff;
    border-radius: 12px;
    padding: 15px;
    box-shadow: 0 8px 20px rgba(0,0,0,0.4);
    display: none;
    z-index: 9999;
    font-family: 'Poppins', sans-serif;
}

.user-dropdown img {
    width: 50px;
    height: 50px;
    border-radius: 50%;
    margin-bottom: 10px;
    object-fit: cover;
}

.user-dropdown .user-name {
    font-weight: bold;
    margin-bottom: 5px;
    word-break: break-word;   /* Wrap long words */
    white-space: normal;   
}

.user-dropdown .user-email {
    font-size: 0.85rem;
    margin-bottom: 10px;
    opacity: 0.8;
    word-break: break-word;   /* Wrap long words */
    white-space: normal;   
}

.user-dropdown button, .user-dropdown a {
    width: 100%;
    padding: 10px;
    border: none;
    border-radius: 8px;
    margin-top: 5px;
    cursor: pointer;
    text-align: center;
    display: block;
    text-decoration: none;
    color: #111;
    background: #fff;
    font-weight: bold;
    transition: 0.3s;
}

.user-dropdown button:hover, .user-dropdown a:hover {
    background: #ddd;
}









/* ================== ORDER MODAL ================== */
#orderModal {
  display: none;
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0,0,0,0.5);
  justify-content: center;
  align-items: center;
  z-index: 1000;
}

#orderModal .modal-content {
  background: #fff;
  padding: 20px 25px;
  border-radius: 12px;
  max-width: 400px;
  width: 90%;
  box-shadow: 0 8px 20px rgba(0,0,0,0.2);
  position: relative;
  animation: fadeIn 0.3s ease-out;
}

#orderModal h2 {
  font-size: 22px;
  color: #0d47a1;
  margin-bottom: 15px;
  text-align: center;
}

#orderModal form input,
#orderModal form textarea {
  width: 100%;
  padding: 10px 12px;
  margin-bottom: 12px;
  border-radius: 6px;
  border: 1px solid #ccc;
  font-size: 15px;
  transition: border 0.2s;
}

#orderModal form input:focus,
#orderModal form textarea:focus {
  outline: none;
  border-color: #0d47a1;
}

#orderModal form button {
  padding: 10px 15px;
  border-radius: 6px;
  border: none;
  font-size: 15px;
  cursor: pointer;
  transition: background 0.2s;
}

#orderModal form button[type="submit"] {
  background: #0d47a1;
  color: #fff;
}

#orderModal form button[type="submit"]:hover {
  background: #08306b;
}

#orderModal form #cancelOrder {
  background: #f5f5f5;
  color: #333;
  margin-left: 10px;
}

#orderModal form #cancelOrder:hover {
  background: #e0e0e0;
}

#deliveryProgress {
  margin-top: 20px;
  display: none;
}

#deliveryProgress .stages {
  display: flex;
  justify-content: space-between;
  font-size: 14px;
  font-weight: 500;
  margin-bottom: 5px;
  color: #0d47a1;
}

#deliveryProgress .progress-bar {
  position: relative;
  height: 12px;
  background: #ddd;
  border-radius: 6px;
  overflow: hidden;
}

#deliveryProgress .progress-bar #progressLine {
  position: absolute;
  height: 100%;
  width: 0;
  background: green;
  border-radius: 6px;
  transition: width 0.4s ease;
}

/* ================== RESPONSIVE ================== */
@media screen and (max-width: 480px) {
  #orderModal .modal-content {
    padding: 15px 20px;
  }

  #orderModal h2 {
    font-size: 20px;
  }

  #orderModal form input,
  #orderModal form textarea {
    font-size: 14px;
    padding: 8px 10px;
  }

  #orderModal form button {
    font-size: 14px;
    padding: 8px 12px;
  }
}

/* ================== ANIMATION ================== */
@keyframes fadeIn {
  from { opacity: 0; transform: scale(0.95); }
  to { opacity: 1; transform: scale(1); }
}

</style>
</head>
<body>

<section class="hero">

 
    <!-- NAVBAR -->
    <div class="navbar">

        <!-- LOGO (Replace image) -->
        <div class="logo">
            <img src="images/icon.png" alt="logo">
        </div>

        <!-- CENTER NAV -->
        <div class="nav-links">
            <a href="/">Home</a>
            <a href="/orders">Orders</a>
            <a href="#">Terms & Conditions</a>
            <a href="#">Privacy Policies</a>
        </div>

        <!-- RIGHT ICONS -->
     <div class="nav-icons">
   <i class="fa-solid fa-magnifying-glass" onclick="RedirectSearch()"></i>
  
    <i class="fa-regular fa-user" id="userIcon"></i>
    <i class="fa-solid fa-bag-shopping" onclick="RedirectCart()"></i>
    <div class="menu-toggle" onclick="toggleMenu()">
        <i class="fa-solid fa-bars"></i>
    </div>
</div>
    </div>



</section>









<!-- User Dropdown -->
<div id="userDropdown" class="user-dropdown">
    <!-- Filled dynamically by JS -->
</div>







<!-- MOBILE MENU -->
<div class="mobile-menu" id="mobileMenu">

    <div class="mobile-header">
        <i class="fa-solid fa-xmark" onclick="toggleMenu()"></i>
    </div>

                <a href="/">Home</a>
            <a href="/orders">Orders</a>
            <a href="#">Terms & Conditions</a>
            <a href="#">Privacy Policies</a>

</div>













<section class="product-details">

    <div class="product-main">
        <div class="product-image">
            <img id="mainProductImage">
        </div>

        <div class="product-info">
            <h1 id="productTitle"></h1>
            <p id="productDescription" class="description"></p>
            <h2 id="productPrice" class="price"></h2>

            <div class="product-actions" id="productActions">
             
            </div>
        </div>
    </div>

    <h3 class="similar-title">Similar Products</h3>

    <div class="similar-products" id="similarProducts"></div>

</section>









<div id="orderModal">
  <div class="modal-content">
       <center> <h2>Confirm Order</h2></center><br>
    <form id="orderForm">
      <input type="text" id="orderName" placeholder="Your Name" required>
      <input type="tel" id="orderPhone" placeholder="Phone Number" required>
      <textarea id="orderAddress" placeholder="Address" required></textarea>
      <button type="submit">Confirm Order</button>
      <button type="button" id="cancelOrder">Cancel</button>
    </form>
    <div id="deliveryProgress">
      <div class="stages">
        <span>Processing</span>
      </div>
      <div class="progress-bar">
        <div id="progressLine"></div>
      </div>
    </div>
  </div>
</div>











<!-- Footer Section -->
<footer class="footer">
  <div class="footer-container">

    <!-- SakhiMart Club Section -->
    <div class="footer-club">
      <img src="images/icon.png" alt="SakhiMart Logo" class="footer-logo">
      <h2>SAKHIMART CLUB <br> WILL SURPRISE YOU</h2>
      <p>Benefits and plenty of surprises are waiting for you!<br>Sign up now</p>
      <a href="#" class="footer-btn">Discover more</a>
    </div>

    <!-- Footer Columns -->
    <div class="footer-columns">

      <!-- Support -->
      <div class="footer-col">
        <h4>Support</h4>
        <ul>
          <li><a href="#">Contact Us</a></li>
          <li><a href="#">Chat with us</a></li>
          <li><a href="#">FAQ</a></li>
        </ul>
      </div>

      <!-- Exclusive Service -->
      <div class="footer-col">
        <h4>Exclusive Service</h4>
        <ul>
          <li><a href="#">Check / Return Order</a></li>
          <li><a href="#">Invite SakhiMart On Wheels</a></li>
          <li><a href="#">COVID Safety Guidelines</a></li>
          <li><a href="#">SakhiMart Loyalty</a></li>
          <li><a href="#">SakhiMart Franchise</a></li>
        </ul>
      </div>

      <!-- Company -->
      <div class="footer-col">
        <h4>Company</h4>
        <ul>
          <li><a href="#">About Us</a></li>
          <li><a href="#">SakhiMart Worldwide</a></li>
          <li><a href="#">CSR</a></li>
          <li><a href="#">Awards & Recognition</a></li>
          <li><a href="#">Become Our Partner</a></li>
          <li><a href="#">Careers</a></li>
        </ul>
      </div>

      <!-- Legals -->
      <div class="footer-col">
        <h4>Legals</h4>
        <ul>
          <li><a href="#">Terms and Conditions</a></li>
          <li><a href="#">Press Release</a></li>
          <li><a href="#">Privacy Policy</a></li>
          <li><a href="#">Cookie Policy</a></li>
          <li><a href="#">Whistle Blow Policy</a></li>
          <li><a href="#">POSH Policy</a></li>
          <li><a href="#">Investor Relations</a></li>
          <li><a href="#">Extract of Form 5A (EPFO Code)</a></li>
        </ul>
      </div>

    </div>
  </div>

  <!-- Bottom Row -->
  <div class="footer-bottom">
    <div class="footer-bottom-left">
      <a href="#"><span>üìç</span>Find a Store</a>
      <a href="#"><span>üåê</span>India | English</a>
    </div>
    <div class="footer-bottom-right">
      <a href="#" class="fab">&#xf09a;</a>
      <a href="#" class="fab">&#xf16d;</a>
      <a href="#" class="fab">&#xf16a;</a>
      <a href="#" class="fab">&#xf0d2;</a>
      <a href="#" class="fab">&#xf08c;</a>
      <a href="#" class="fab">&#xf099;</a>
    </div>
  </div>

  <p class="footer-copy">¬© 2026 SakhiMart Brand ‚Äì SakhiMart India ‚Äì CIN: L19201WB1931PLC007261</p>
</footer>






<script>


const mobileMenu = document.getElementById("mobileMenu");

function toggleMenu(){
    mobileMenu.classList.toggle("active");
}

window.addEventListener("click", function(e){
    if(!mobileMenu.contains(e.target) && 
       !e.target.closest(".menu-toggle")){
        mobileMenu.classList.remove("active");
    }
});


function RedirectCart(){
    window.location.href="/cart"
}


function RedirectSearch(){
    window.location.href = "/";
}


const urlParams = new URLSearchParams(window.location.search);
const productId = urlParams.get("id");
let product;

loadProduct();

async function loadProduct(){

    const res = await fetch(`/api/product/${productId}`);
    const product = await res.json();

    document.getElementById("mainProductImage").src = product.image;
    document.getElementById("productTitle").innerText = product.title;
    document.getElementById("productDescription").innerText = product.description;
    document.getElementById("productPrice").innerText = "‚Çπ" + product.price;
 document.getElementById("productActions").innerHTML = `   <button class="cart-btn" onclick="addToCartHandler('${product._id}')">Add to Cart</button>
                  <button class="buy-btn" ">Buy Now</button>`;



document.querySelector(".buy-btn").addEventListener("click", () => showOrderForm(product));

    loadSimilarProducts(product.section, product.category);
}





let currentOrderProduct = {};

function showOrderForm(product){
    const token = localStorage.getItem("token");
    const userEmail = localStorage.getItem("userEmail"); // ‚úÖ get user email

    if(!token || !userEmail){
        alert("‚ùå You must be logged in to place an order!");
        return window.location.href = "/login";
    }

    currentOrderProduct = product; // store for submit
    document.getElementById("orderModal").style.display = "flex";
}

// Cancel order modal
document.getElementById("cancelOrder").addEventListener("click", ()=>{
    document.getElementById("orderModal").style.display = "none";
});

// Handle order form submit
document.getElementById("orderForm").addEventListener("submit", async (e)=>{
    e.preventDefault();

    const name = document.getElementById("orderName").value;
    const phone = document.getElementById("orderPhone").value;
    const address = document.getElementById("orderAddress").value;
    const userEmail = localStorage.getItem("userEmail"); // ‚úÖ email only

    if(!name || !phone || !address){
        return alert("‚ùå Please fill all fields!");
    }

    const qty = currentOrderProduct.qty || 1;

    const orderData = {
        product: {
            productId: currentOrderProduct._id,
            title: currentOrderProduct.title,
            price: currentOrderProduct.price,
            qty: qty
        },
        userEmail, // ‚úÖ only email
        customer: { name, phone, address }, // ‚úÖ nested
        delivery: [
            { stage: "Reached", status: false },
            { stage: "Shipped", status: false },
            { stage: "Delivered", status: false }
        ],
        createdAt: new Date()
    };

    try{
        await fetch("/api/order", {
            method: "POST",
            headers: {"Content-Type":"application/json"},
            body: JSON.stringify(orderData)
        });

        // Show delivery progress visually
        const progressLine = document.getElementById("progressLine");
        const deliveryProgress = document.getElementById("deliveryProgress");
        deliveryProgress.style.display = "block";
        progressLine.style.width = "0%";

        setTimeout(()=> progressLine.style.width = "100%", 50);

        setTimeout(()=>{
            alert("‚úÖ Order Confirmed!");

            // WhatsApp redirect
            const totalPrice = currentOrderProduct.price * qty;
            const message = `Hi, I want to order this product:
*Product:* ${currentOrderProduct.title}
*Quantity:* ${qty}
*Unit Price:* ‚Çπ${currentOrderProduct.price}
*Total Price:* ‚Çπ${totalPrice}
*Name:* ${name}
*Phone:* ${phone}
*Address:* ${address}
*Email:* ${userEmail}`;

            window.open(`https://wa.me/917076119520?text=${encodeURIComponent(message)}`, "_blank");

            // Reset modal
            deliveryProgress.style.display = "none";
            progressLine.style.width = "0";
            document.getElementById("orderModal").style.display = "none";
        }, 2000);

    } catch(err){
        console.error(err);
        alert("‚ùå Order failed, try again!");
    }
});

// Optional visual animation (kept for UI)
async function animateDeliveryProgress(){
    const line = document.getElementById("progressLine");
    const steps = [33, 66, 100];
    for(let pct of steps){
        await new Promise(r=>{
            let width = 0;
            const interval = setInterval(()=>{
                width++;
                line.style.width = width + "%";
                if(width >= pct){
                    clearInterval(interval);
                    r();
                }
            }, 10);
        });
    }
}




async function loadSimilarProducts(section, category){

   const res = await fetch(`/api/products-by-category?section=${section}&category=${category}`);
    const products = await res.json();
product=products;
    const similarContainer = document.getElementById("similarProducts");
    similarContainer.innerHTML = "";
console.log("Similar Products:", products);
    products.forEach(item => {

        if(item._id.toString() !== productId){

            similarContainer.innerHTML += `
            <div class="similar-card" onclick="goToProduct('${item._id}')">
                <img src="${item.image}">
                <h4>${item.title}</h4>
                <p>‚Çπ${item.price}</p>
            </div>
            `;
        }
    });
}

function goToProduct(id){
    window.location.href = `/product-item?id=${id}`;
}














// Toggle dropdown on user icon click
const userIcon = document.getElementById("userIcon");
const userDropdown = document.getElementById("userDropdown");

userIcon.addEventListener("click", () => {
    userDropdown.style.display = userDropdown.style.display === "block" ? "none" : "block";
});

// Close dropdown if clicked outside
window.addEventListener("click", (e) => {
    if(!userDropdown.contains(e.target) && e.target !== userIcon){
        userDropdown.style.display = "none";
    }
});

// Render user info
function renderUserDropdown() {
    const token = localStorage.getItem("token");
    const name = localStorage.getItem("userName");
    const email = localStorage.getItem("userEmail");

    if(token && name && email){
        userDropdown.innerHTML = `
            <img src="https://cdn.pixabay.com/photo/2015/10/05/22/37/blank-profile-picture-973460_1280.png" alt="DP">
            <div class="user-name">${name}</div>
            <div class="user-email">${email}</div>
            <button onclick="logout()">Logout</button>
        `;
    } else {
        userDropdown.innerHTML = `
            <div style="text-align:center; margin-bottom:10px;">Not signed in</div>
            <a href="/login">Sign In</a>
        `;
    }
}

// Logout function
function logout(){
    localStorage.removeItem("token");
    localStorage.removeItem("userName");
    localStorage.removeItem("userEmail");
    renderUserDropdown();
    // Optional: redirect to login page
    window.location.href = "/login";
}

// Initial render
renderUserDropdown();














// Handler for Add to Cart button
function addToCartHandler(productId) {
    const products = product.find(p => p._id === productId);
    
    // Always check current user info
    const token = localStorage.getItem("token");
    const userEmail = localStorage.getItem("userEmail");

    if (!token || !userEmail) {
        alert("Please login to add items to cart!");
        window.location.href = "/login";
        return;
    }

    addToCart(products);
}

function addToCart(product) {
    if (!product) return;

    let cart = JSON.parse(localStorage.getItem("cart")) || [];

    const existing = cart.find(item => item._id === product._id);
    if (existing) {
        existing.qty += 1;
    } else {
        cart.push({...product, qty: 1});
    }

    localStorage.setItem("cart", JSON.stringify(cart));

 
    alert(`${product.title} added to cart!`);
}










</script>

</body>
</html>